# 🎙️ 面接音声分析プログラム

このプログラムは、面接音声ファイル（m4a形式）を自動分析して、面接者の話し方や表現パターンを評価する AI ツールです。

## ✨ 何ができるの？

面接音声から以下の **7つの評価指標** を自動で分析します：

1. **ポジティブ/ネガティブワード比率** - 前向きな表現の使用度
2. **躊躇率** - 「えーと」「あのー」などの迷い表現の頻度
3. **粘り強さ表現頻度** - 「頑張った」「継続した」などの表現の使用度
4. **平均応答速度** - 質問への回答の速さ
5. **接続詞使用頻度** - 「しかし」「そして」などの論理的な話し方
6. **発話速度** - 話すスピード（WPM: Words Per Minute）
7. **一人称/三人称比率** - 自分と他人への言及バランス

## 📁 フォルダ構成

```
面接音声分析プログラム/
├── interview_analyzer.py    # メインプログラム（これを実行）
├── README.md               # このファイル（使い方説明）
├── requirements.txt        # 必要なライブラリ一覧
├── input/                  # 🎵 音声ファイル置き場
│   └── interview.m4a      # ← ここに分析したい面接音声を置く
├── database/              # 📚 言語パターンデータベース
│   └── speech_patterns.yaml
├── cache/                 # ⚡ 高速化用キャッシュ
├── output/                # 📊 分析結果の出力先
└── models/                # 🤖 AI モデル保存先
```

## 🔧 初回セットアップ（最初の1回のみ）

### 前提条件
- Python 3.8以上がインストールされている
- インターネット接続がある

### ステップ1: 仮想環境の作成と有効化

**macOS/Linux の場合:**
```bash
# 仮想環境を作成
python -m venv interview_env

# 仮想環境を有効化
source interview_env/bin/activate
```

**Windows の場合:**
```cmd
# 仮想環境を作成
python -m venv interview_env

# 仮想環境を有効化
interview_env\Scripts\activate
```

### ステップ2: 必要なライブラリのインストール
```bash
# 必要なライブラリを一括インストール
pip install -r requirements.txt
```

💡 **仮想環境について:**
- プログラム専用の環境を作成することで、他のプロジェクトとの競合を防げます
- 使用後は `deactivate` コマンドで仮想環境を終了できます
- 次回使用時は「仮想環境を有効化」のコマンドから始めてください

## 🚀 使い方（3ステップ）

### ステップ1: 音声ファイルの準備
- 分析したい面接音声ファイル（m4a形式）を用意
- ファイル名を `interview.m4a` に変更
- `input/` フォルダに置く

### ステップ2: プログラム実行
ターミナル（コマンドプロンプト）で以下を実行：

```bash
# 仮想環境が有効化されていることを確認してから実行
python interview_analyzer.py
```

### ステップ3: 結果確認
`output/` フォルダに以下のファイルが作成されます：

#### 📊 グラフ画像（PNG形式）
- `評価指標_レーダーチャート.png` - 全体評価の可視化
- `発話パターン分析.png` - 詳細パターン分析
- `時系列発話パターン.png` - 時間経過による変化
- `応答速度分析.png` - 応答速度の分布

#### 📄 データファイル（CSV形式）
- `面接分析結果_概要.csv` - 評価指標まとめ
- `面接分析結果_詳細.csv` - 全発話の詳細データ

## ⚙️ 初回実行について

**初回実行時の注意点：**
- インターネット接続が必要です
- AIモデルのダウンロードで5-10分程度かかります
- 2回目以降は数分で完了します

**実行中の画面例：**
```
🎙️  面接音声分析プログラム開始
============================================================
=== 面接音声分析プログラム初期化中 ===
日本語解析ツールを準備中...
言語パターンデータを読み込み中...
   ✓ パターンファイル読み込み完了: 6種類
初期化完了！

① 音声ファイル形式変換
   ✓ 変換完了 (2.1秒)
   音声ファイル長: 180.5秒

② 音声文字起こし（Whisper AI使用）
   Whisper音声認識モデルを読み込み中...
   （初回実行時はダウンロードのため数分かかります）
   ✓ Whisperモデル読み込み完了
   ✓ 文字起こし完了 (45.2秒)
   認識セグメント数: 28個
   総文字数: 1,245文字
```

## 🔄 2回目以降の実行

同じ音声ファイルの場合、結果がキャッシュされるため高速実行されます：

```
② キャッシュされた分析結果を読み込み
   ✓ キャッシュ読み込み完了 (0.3秒)
   読み込みセグメント数: 28個
   ※ 新しい音声で分析したい場合は cacheフォルダを削除してください
```

## 📈 結果の見方

### レーダーチャート
- 0-10のスケールで各指標を表示
- 外側に向かうほど良い評価
- バランスの取れた形が理想的

### 評価レベル
- **良好** 🟢 - 優れた結果
- **普通** 🟡 - 標準的な結果  
- **要改善** 🔴 - 改善の余地あり

### CSVファイル
- Excelで開いて詳細分析可能
- 各発話の時刻と内容を確認
- パターン別の統計データを確認

## 🛠️ 新しい音声ファイルで分析する場合

1. `cache/` フォルダを削除（キャッシュクリア）
2. `input/interview.m4a` を新しいファイルに置き換え
3. プログラムを再実行

## ⚠️ よくある問題と解決方法

### 「音声ファイルが見つかりません」エラー
```
❌ エラー: 音声ファイルが見つかりません
   input/interview.m4a に面接音声ファイル（m4a形式）を配置してください
```
**解決方法:** `input/` フォルダに `interview.m4a` ファイルがあるか確認

### 日本語文字化け
**解決方法:** CSVファイルをExcelで開く際は「UTF-8」エンコーディングを選択

### メモリ不足エラー
**解決方法:** 他のアプリケーションを閉じてから実行

### インターネット接続エラー
**解決方法:** 安定したインターネット接続環境で実行

## 💡 分析結果の活用方法

### 面接準備として
1. **躊躇率が高い場合** → 話す内容を事前に整理
2. **応答速度が遅い場合** → 想定質問の練習
3. **ポジティブワードが少ない場合** → 前向きな表現を意識

### 継続的改善として
1. 定期的に同じ質問での面接練習を録音
2. 指標の変化を追跡
3. 改善点を客観的に把握

## 🔒 プライバシーについて

- 音声データはローカル環境のみで処理
- インターネットへの音声アップロードはありません
- AIモデルのダウンロード時のみネット接続が必要